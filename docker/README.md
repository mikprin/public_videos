# Ультимативный гайд по Docker



# Установка

## Linux

1. Установить ядро докер для вашей платформы. Подробно тут: 

## Windows


## Используем утилиту `docker`

Одной из самых простых и удачных утилит для нативного управления контейнерами является встроенная утилита `docker`.
Чтобы вызвать ее, нужно установить движок`docker-engine` и получаете ее в подарок. 

Добавляя к слову `docker` другие команды можно управлять контейнерами.

Чтобы перечислить используемые и установленные контейнеры используйте `docker ps`. Эта утилита, как и многие последующие вдохновлена UNIX утилитой `ps` которая перечисляет запущенные процессы.

Для обращения к контейнеру можно использовать его имя, которое дано было ему при создании, либо уникальный ID. Тут важно не путать имя контейнера и его образа. Ибо у вас может быть несколько контейнеров с одинаковым образом. Например два контейнера с базами данных Postgres

* `docker ps` - перечислить работающие контейнеры
* `docker ps -a` - перечислить все установленные контейнеры (в том числе остановленные)
* `docker stop container_name/id` - остановить запущенный контейнер
* `docker start container_name/id` - запустить остановленный контейнер
* `docker rm container_name/id` - удалить остановленный контейнер. (Используя флаг `--force` можно удалить и работающий, но лучше все же остановить его)


## Работа с образами

* `docker images` - перечислить загруженные образы
* `docker rmi hello_world` - удалить образ с именем `hello_world`
* `docker pull hello-world` - скачать образ с именем `hello world` из docker hub

## Запуск контейнеров

* `docker run hello-world` - скачать и (или) запустить образ контейнера `hello-world`. Делает все нужные шаги
* `docker run hello-world -d` - добавьте `-d` чтобы не прикреплять терминал к контейнеру (контейнер будет существовать на фоне)
* `docker run hello-world --name my_hello_world` - скачать и (или) запустить образ контейнера `hello-world`. Дать контейнеру имя `my_hello_world`, иначе у контейнера будет случайное имя. Имя используется для обращения к контейнеру.
* `docker-compose up -d` - использовать файл `docker-compose.yaml` в текущей папке и запустить (аналогично `docker run`) все контейнеры (сервисы) оттуда.
* `docker-compose stop` - использовать файл `docker-compose.yaml` в текущей папке и остановить все контейнеры (сервисы) оттуда.

## Работа с портами

`docker run --port 8888:80 hello_world` - скачать и (или) запустить контейнер `hello-world`, но соединить порт 8888 системы с портом 80 контейнера.

## Работа с общими папками

`docker run --volume /docker/:/os_folder hello_world` - скачать и (или) запустить контейнер `hello-world`, но соединить `/docker` системы с директорией `/os_folder` контейнера.

## Docker compose

Конманды `rm`,`run`,`stop` работают в связке аналогичной `docker run` но для контейнеров перечсисленных в `docker-compose.yaml`.

Пример `docker-compose.yaml` с комментариями:

```
  hello_world:
    container_name: postgresql_database # Имя контейнера (для обращения к нему)
    image: hello_world # Название образа
    restart: always #
    ports:
      - 1111:1111" # Прокидывание порта 1111 контейнера в систему
    environment:
      MY_VAR=1 # Передача в окружение контейнера переменной MY_VAR равной 1

```